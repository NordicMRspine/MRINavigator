<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · MRINavigator.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MRINavigator.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../GettingStarted/">Getting Started</a></li><li><a class="tocitem" href="../Pipelines/">Pipelines</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Run-compact-pipeline"><span>Run compact pipeline</span></a></li><li><a class="tocitem" href="#Coil-sensitivity-maps"><span>Coil sensitivity maps</span></a></li><li><a class="tocitem" href="#Find-centerline"><span>Find centerline</span></a></li><li><a class="tocitem" href="#Utils"><span>Utils</span></a></li><li><a class="tocitem" href="#Navigator-correction"><span>Navigator correction</span></a></li><li><a class="tocitem" href="#Adjust-data"><span>Adjust data</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/main/docs/src/API.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><p>This page contains documentation of the public API of MRINavigator. In the Julia REPL one can access this documentation by entering the help mode with <code>?</code> and then writing the function for which the documentation should be shown.  For example: <code>? findCenterline</code></p><h1 id="Run-compact-pipeline"><a class="docs-heading-anchor" href="#Run-compact-pipeline">Run compact pipeline</a><a id="Run-compact-pipeline-1"></a><a class="docs-heading-anchor-permalink" href="#Run-compact-pipeline" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.defaultNavParams" href="#MRINavigator.defaultNavParams"><code>MRINavigator.defaultNavParams</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">params = defaultNavParams()</code></pre><p>Define default parameters for data loading, navigator correction and image reconstruction.</p><p><strong>Default parameters options are</strong></p><ul><li><code>slices::Union{Nothing, Vector}</code>    - a vector containing the number of the slices to be loaded, nothing means all slices</li><li><code>echoes::Union{Nothing, Vector}</code>    - a vector containing the number of the echoes to be loaded, nothing means all echoes</li><li><code>rep::Int</code>                          - repetition to be loaded, the first repetition is 0. It is mandatory to select one</li><li><code>comp_sensit::Bool</code>                 - compute the sensitivity maps using the reference scan</li><li><code>comp_centerline::Bool</code>             - use the Spinal Cord Toolbox (SCT) to find the centerlne position</li><li><code>trust_SCT::Bool</code>                   - trust SCT or display the resutls and wait for user feedback with the julia REPL</li><li><code>use_centerline::Bool</code>              - use the spinal cord centerline information in the navigator-based correction</li><li><code>corr_type::String</code>                 - correction type. Options: &quot;none&quot;, &quot;knav&quot;, &quot;FFT&quot;, &quot;FFT_unwrap&quot;</li><li><code>FFT_interval::String</code>              - interval in mm to be considered for the FFT based approach</li><li><code>mask_thresh::String</code>               - masking threshold: increase for reduced mask size, decrease for extended mask size</li></ul><p><strong>Additional required parameters are</strong></p><ul><li><code>path_imgData::String</code>              - path to the image data file in ISMRMRD format</li><li><code>path_refData::String</code>              - path to the reference data file in ISMRMRD format</li><li><code>path_sensit::String</code>               - path to the file where the sensitivity maps will be saved. The file extension must be .mat</li><li><code>path_noise::String</code>                - path to the file where the noise acquisition will be saved. The file extension must be .jld2</li><li><code>path_results::String</code>              - path to the results folder</li></ul><p><strong>Additional optional parameters are</strong></p><ul><li><code>path_niftiMap::String</code>             - path to the file where the reconstructed reference data will be saved in nifti format. The file extension must be .nii</li><li><code>path_centerline::String</code>           - path to the folder where the Spinal Cord Toolbox (SCT) centerline results will be saved</li><li><code>path_physio::String</code>              - path to the physiological trace recording in .mat format. The variable should be a two columns vector (1:time [ms], 2:trace) called data.                                       The time should be expressed in seconds from the beginning of the day and contain time points before and after the image acquisiton (at least 4 s).</li></ul><p>ISMRMRD reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.26089 SCT reference: https://spinalcordtoolbox.com</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/NavParameters.jl#L3-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.runNavPipeline" href="#MRINavigator.runNavPipeline"><code>MRINavigator.runNavPipeline</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">runNavPipeline(params::Dict{Symbol, Any})</code></pre><p>Run the navigator pipeline. Return reconstructed image and navigator correction output (check NavCorr!).</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict{Symbol, Any}</code> - MRINavigator parameter structure, check defaultNavParams() for info</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/main.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.saveNoise" href="#MRINavigator.saveNoise"><code>MRINavigator.saveNoise</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">saveNoise(path_imgData::String, path_noise::String)</code></pre><p>Extract the noise acquisition form the image data and save it.   Call ExtractNoiseData!, check this function for more info.</p><p><strong>Arguments</strong></p><ul><li><code>path_imgData::String</code> - path to the ISMRMRD file containing the image data</li><li><code>path_noise::String</code> - path where the noise file will be saved</li></ul><p>ISMRMRD reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.26089</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/main.jl#L87-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.loadRawData" href="#MRINavigator.loadRawData"><code>MRINavigator.loadRawData</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">loadRawData(params::Dict{Symbol, Any})</code></pre><p>Load the raw data file saved in ISMRMRD format in julia using MRIReco.jl Call ExtractNoiseData!, OrderSlices!, ReverseBipolar!, RemoveRef!. Check the specific functions for info.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792 ISMRMRD reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.26089</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict{Symbol, Any}</code> - MRINavigator parameter structure, check defaultNavParams() for info</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/main.jl#L111-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.convertRawToAcq" href="#MRINavigator.convertRawToAcq"><code>MRINavigator.convertRawToAcq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convertRawToAcq(rawData::::RawAcquisitionData)</code></pre><p>Convert raw data to acquisition data using MRIReco.jl, then apply small adjustments. Return acquisition data structure.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/main.jl#L147-L157">source</a></section></article><h2 id="Coil-sensitivity-maps"><a class="docs-heading-anchor" href="#Coil-sensitivity-maps">Coil sensitivity maps</a><a id="Coil-sensitivity-maps-1"></a><a class="docs-heading-anchor-permalink" href="#Coil-sensitivity-maps" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.CompSensit" href="#MRINavigator.CompSensit"><code>MRINavigator.CompSensit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sensit = CompSensit(acq::AcquisitionData, thresh = 0.13)</code></pre><p>Compute the coils sensitivity maps with masking tuned for spinal cord imaging. Use MRICoilSensitivities.jl from MRIReco.jl alternatively.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>acqData::RawAcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>tresh::Float64</code> - masking threshold: increase for reduced mask size, decrease for extended mask size</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/CoilSensMap.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.CompRoughMask" href="#MRINavigator.CompRoughMask"><code>MRINavigator.CompRoughMask</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mask = CompRoughMask(acq::AcquisitionData, slices::Int64, thresh)</code></pre><p>Return a rough mask for multiple slices that may not be homogeneous.</p><p><strong>Arguments</strong></p><ul><li><code>acqData::RawAcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>slices::Int64</code> - number of slices in acquisition data</li><li><code>tresh::Float64</code> - masking threshold: increase for reduced mask size, decrease for extended mask size</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/CoilSensMap.jl#L40-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.ResizeSensit!" href="#MRINavigator.ResizeSensit!"><code>MRINavigator.ResizeSensit!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sensit = ResizeSensit!(sensit::Array{Complex{T},4}, acqMap::AcquisitionData, acqData::AcquisitionData)</code></pre><p>Resize and resample the coil sensitivity map to match the acquisition data field of view and resolution. This step is needed for the image reconstruction to run. Image data and reference data must have the same slice center.</p><p><strong>Arguments</strong></p><ul><li><code>sensit::Array{Complex{T},4}</code> - output of CompSensit(acq::AcquisitionData, thresh)</li><li><code>acqMap::RawAcquisitionData</code> - acquisition data structure obtained converting raw reference data with MRIReco.jl</li><li><code>acqData::RawAcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/CoilSensMap.jl#L141-L154">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.CompResizeSaveSensit" href="#MRINavigator.CompResizeSaveSensit"><code>MRINavigator.CompResizeSaveSensit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CompResizeSaveSensit(acqMap::AcquisitionData, acqData::AcquisitionData, path_sensit::String)</code></pre><p>Compute, resize to the image data dimension and save the coils sensitivity maps with masking tuned for spinal cord imaging. Use MRICoilSensitivities.jl from MRIReco.jl alternatively.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>acqMap::RawAcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>acqData::RawAcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>tresh::Float64</code> - masking treshold: increase for reduced mask size, decrease for extended mask size</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/CoilSensMap.jl#L241-L253">source</a></section></article><h2 id="Find-centerline"><a class="docs-heading-anchor" href="#Find-centerline">Find centerline</a><a id="Find-centerline-1"></a><a class="docs-heading-anchor-permalink" href="#Find-centerline" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.findCenterline" href="#MRINavigator.findCenterline"><code>MRINavigator.findCenterline</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">findCenterline(params::Dict{Symbol, Any})</code></pre><p>Reconstruct the reference data, call spinal cord toolbox and find spinal cord centerline. If trust_SCT = false in the parameters dictionary the user interaction is required in the Julia REPL.</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict{Symbol, Any}</code> - paramerters dictionary</li></ul><p>SCT reference: https://spinalcordtoolbox.com</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/SpineCenterline.jl#L134-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.ReconstructMap" href="#MRINavigator.ReconstructMap"><code>MRINavigator.ReconstructMap</code></a> — <span class="docstring-category">Function</span></header><section><div><p>ReconstructMap(path_ref::String)</p><p>Reconstruct the coil sensitivity map using the MRIReco.jl function.</p><p><strong>Arguments</strong></p><ul><li><code>path_rep::String</code> - path of reference data in ISMRMRD format</li><li><code>thresh::Float64</code> - masking threshold: increase for reduced mask size, decrease for extended mask size</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792 ISMRMRD reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.26089</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/SpineCenterline.jl#L28-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.ReconstructSaveMap" href="#MRINavigator.ReconstructSaveMap"><code>MRINavigator.ReconstructSaveMap</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ReconstructSaveMap(path_nifti::String, path_ref::String, thresh::Float64)</code></pre><p>Reconstruct the coil sensitivity map using the MRIReco.jl function and save it in nifti format without spatial information.</p><p><strong>Arguments</strong></p><ul><li><code>path_nifti::String</code> - path of the nifti file. The file must have .nii extension</li><li><code>path_rep::String</code> - path of reference data in ISMRMRD format</li><li><code>thresh::Float64</code> - masking threshold: increase for reduced mask size, decrease for extended mask size</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792 ISMRMRD reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.26089</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/SpineCenterline.jl#L4-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.callSCT" href="#MRINavigator.callSCT"><code>MRINavigator.callSCT</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">callSCT(params::Dict{Symbol, Any})</code></pre><p>Call spinal cord toolbox and find spinal cord centerline. If trust_SCT = false in the parameters dictionary the user interaction is required in the Julia REPL</p><p><strong>Arguments</strong></p><ul><li><code>params::Dict{Symbol, Any}</code> - paramerters dictionary</li></ul><p>SCT reference: https://spinalcordtoolbox.com</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/SpineCenterline.jl#L84-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.comp_centerline_pos" href="#MRINavigator.comp_centerline_pos"><code>MRINavigator.comp_centerline_pos</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">centerline = comp_centerline_pos(addData::additionalNavInput)</code></pre><p>Convert and return centerline position from the reference data cordinate to the acquisition data coordinates (number of voxels).</p><p><strong>Arguments</strong></p><ul><li><code>addData::additionalNavInput</code> - mandatory additional data structure obtained with the constructor: additionalNavInput</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Navigator.jl#L126-L133">source</a></section></article><h2 id="Utils"><a class="docs-heading-anchor" href="#Utils">Utils</a><a id="Utils-1"></a><a class="docs-heading-anchor-permalink" href="#Utils" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.Reconstruct" href="#MRINavigator.Reconstruct"><code>MRINavigator.Reconstruct</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">img = Reconstruct(acqd::AcquisitionData, sensit::Array{Complex{T},4}, noisemat::Union{Array{Complex{T}},Nothing} = nothing)</code></pre><p>Call MRIReco.jl reconstruction function and return reconstructed image. Only single repetition in input.</p><p><strong>Arguments</strong></p><ul><li><code>acqData::RawAcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>sensit::Array{Complex{T},4}</code> - coil sensitivity map matrix computed with CompSensit(acq::AcquisitionData, thresh = 0.135)</li><li><code>noisemat::Union{Array{Complex{T}},Nothing} = nothing</code> - noise data extracted from the raw data structure with ExtractNoiseData!(rawData::RawAcquisitionData)</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Reconstruction.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.directreco" href="#MRINavigator.directreco"><code>MRINavigator.directreco</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">img = directreco(acq::AcquisitionData)</code></pre><p>Call MRIReco.jl reconstruction function and return reconstructed image. Reconstruct coils separately.</p><p><strong>Arguments</strong></p><ul><li><code>acqData::RawAcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Reconstruction.jl#L41-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.niftiSaveImg" href="#MRINavigator.niftiSaveImg"><code>MRINavigator.niftiSaveImg</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">niftiSaveImg(img::AbstractArray{T}, acq::AcquisitionData, path_nifti::String)</code></pre><p>Save the module of the reconstruction output in nifti format, without spatial information.</p><p><strong>Arguments</strong></p><ul><li><code>img::AbstractArray{T}</code> - reconstruction output</li><li><code>acq::AcquisitionData</code> - reconstruction input (MRIReco.jl) needed for saving the voxel dimension</li><li><code>path_nifti::String</code> - path of the nifti file. The file must have .nii extension</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/SpineCenterline.jl#L54-L65">source</a></section></article><h2 id="Navigator-correction"><a class="docs-heading-anchor" href="#Navigator-correction">Navigator correction</a><a id="Navigator-correction-1"></a><a class="docs-heading-anchor-permalink" href="#Navigator-correction" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.NavCorr!" href="#MRINavigator.NavCorr!"><code>MRINavigator.NavCorr!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">navOutput = NavCorr!(nav::Array{Complex{T}, 4}, acqData::AcquisitionData, params::Dict{Symbol, Any}, addData::additionalNavInput) where {T}</code></pre><p>Compute the navigator-based correction and apply it to the acquisition data. Multiple pipelines are available: &quot;knav&quot;, &quot;FFT&quot; and &quot;FFT<em>unwrap&quot;. Return navigator trace, spinal cord centerline in the reconstructed image coordinates,  Correlation between navigator and belt data for each slice and position of wrapped points for each slices. Please choose the pipeline using the corr</em>type filed in the params dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>nav::Array{Complex{T}, 4}</code> - navigator profiles obtained with the ExtractNavigator function</li><li><code>acqData::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>params::Dict{Symbol, Any}</code> - navigator correction paramerters dictionary</li><li><code>addData::additionalNavInput</code> - mandatory additional data structure obtained with the constructor: additionalNavInput</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Navigator.jl#L3-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.wrap_corr!" href="#MRINavigator.wrap_corr!"><code>MRINavigator.wrap_corr!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">wrap_corr!(nav::Array{Float64, 4}, wrapped_points::Array{Int8, 2}, correlation::Union{Array{Float64, 1}, Matrix{Float64}}, slices::Int64)</code></pre><p>Unwrap the wrapped points identified with the find_wrapped funtion. These functions can be used only if physiological recording is available.</p><p><strong>Arguments</strong></p><ul><li><code>nav::Array{T, 4}</code> - phase estimates obtained from the navigator data</li><li><code>wrapped_points::Array{Int8, 2}</code> - position of the wrapped points, output of find_wrapped</li><li><code>correlation::Union{Array{Float64, 1}</code> - correlation values between the physiological recording the navigator estimates for each slice. Output of find_wrapped</li><li><code>slices::Int64</code> - number of slices</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Navigator.jl#L245-L256">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.find_wrapped" href="#MRINavigator.find_wrapped"><code>MRINavigator.find_wrapped</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_wrapped(nav::Array{Float64, 4}, nav_time::Array{Float64, 2}, trace::Array{Float64, 2}, slices::Int64)</code></pre><p>Identify the position of the wrapped points in the navigator phase estimates. The respiratory belt recording is necessary. Return the position of the wrapped points, the correlation between each navigator slice and the trace data, the aligned and interpolated trace data.</p><p><strong>Arguments</strong></p><ul><li><code>nav::Array{Float64, 4}</code>      - navigator phase estimates</li><li><code>nav_time::Array{Float64, 2}</code> - navigator data timestamps in ms from the beginning of the day, for each slice</li><li><code>trace::Array{Float64, 2}</code>    - physiological trace recording. Two columns vector (1:time [ms], 2:trace). The first column contains the timestamps in ms from the beginning of the day.                                   Include time points before and after the image acquisition (at least 2 s).</li><li><code>slices::Int64</code>               - number of slices</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Unwrap.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.TE_corr!" href="#MRINavigator.TE_corr!"><code>MRINavigator.TE_corr!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nav = TE_corr!(nav::Array{T, 4}, acqd::AcquisitionData, dt_nav::Float64, TE_nav::Float64, numsamples::Int64, numechoes::Int64) where {T}</code></pre><p>Compute the phase value for the navigator correction basing on the exact acquisition time of each data sample in the line and for each echo. Return a four-dimensional navigator array.</p><p><strong>Arguments</strong></p><ul><li><code>nav::Array{T, 4}</code> - phase estimates obtained from the navigator data</li><li><code>acqData::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>dt_nav::Float64</code> - time interval between two samples in the frequency encoding direction</li><li><code>TE_nav::Float64</code> - echo time of the navigator readout</li><li><code>numsamples::Int64</code> - number of samples for each profile</li><li><code>numechoes::Int64</code> - number of echoes</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Navigator.jl#L154-L169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.apply_corr!" href="#MRINavigator.apply_corr!"><code>MRINavigator.apply_corr!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">apply_corr!(nav::Array{T, 4}, acqd::AcquisitionData, numechoes::Int64, numlines::Int64, numsamples::Int64, numslices::Int64) where {T}</code></pre><p>Apply the navigator-based correction to the acquisition data structure obtained loading the raw data with MRIReco.jl. After applying the correction the image should be reconstructed. Use the reconstruct function.</p><p><strong>Arguments</strong></p><ul><li><code>nav::Array{T, 4}</code> - phase estimates obtained from the navigator data</li><li><code>acqd::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>numechoes::Int64</code> - number of echoes</li><li><code>numlines::Int64</code> - number of lines (profiles) for each slice and echo</li><li><code>numsamples::Int64</code> - number of samples for each profile</li><li><code>numslices::Int64</code> - number of slices</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/Navigator.jl#L188-L203">source</a></section></article><h2 id="Adjust-data"><a class="docs-heading-anchor" href="#Adjust-data">Adjust data</a><a id="Adjust-data-1"></a><a class="docs-heading-anchor-permalink" href="#Adjust-data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.OrderSlices!" href="#MRINavigator.OrderSlices!"><code>MRINavigator.OrderSlices!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">OrderSlices!(rawData::RawAcquisitionData)</code></pre><p>Spatially order the slices in the MRIReco.jl raw data structure. The slices are ordered basing on the position coordinates saved in each profile. If these are not present the slices can not be ordered.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.ExtractFlags" href="#MRINavigator.ExtractFlags"><code>MRINavigator.ExtractFlags</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">flags = ExtractFlags(rawData::RawAcquisitionData)</code></pre><p>Extract the acquisition flags from the MRIReco.jl raw data profiles. Return a 31-element vector for each profile.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L35-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.ExtractNoiseData!" href="#MRINavigator.ExtractNoiseData!"><code>MRINavigator.ExtractNoiseData!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">noisemat = ExtractNoiseData!(rawData::RawAcquisitionData, flags::Array{Int64})</code></pre><p>Extract and return the noise acquisition from the MRIReco.jl raw data. The noise acquisition is usually the first profile with slice = 0, contrast = 0, repetition = 0. The noise profile should have the 19th flag element equal to 1. Check this with ExtractFlags if errors occur.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L60-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.ReverseBipolar!" href="#MRINavigator.ReverseBipolar!"><code>MRINavigator.ReverseBipolar!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ReverseBipolar!(rawData::RawAcquisitionData)</code></pre><p>Reflect the MRIReco.jl raw data profiles for bipolar acquisition.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L99-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.RemoveRef!" href="#MRINavigator.RemoveRef!"><code>MRINavigator.RemoveRef!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">RemoveRef!(rawData::RawAcquisitionData, slices::Union{Vector{Int64}, Nothing}, echoes::Union{Vector{Int64}, Nothing})</code></pre><p>Remove reference data from acquisitions with phase stabilization on Siemens scanners. To be applied before the navigator-based correction. Necessary when the reference data is acquired before the image data. Make sure that this is needed on your data checking the time stamps. For Siemens: It is possible to read raw data with mapVBVD in Matlab. The reference data to be removed is called phasestabRef in mapVBVD. Not robust for sequences with concatenations &gt; 1. Not robust to repeated calls, modifies rawData.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792 mapVBVD reference: https://github.com/CIC-methods/FID-A/blob/master/inputOutput/mapVBVD/README.md</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L131-L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.CopyTE!" href="#MRINavigator.CopyTE!"><code>MRINavigator.CopyTE!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CopyTE!(rawData::RawAcquisitionData, acqData::AcquisitionData)</code></pre><p>Copy the TE values from the MRIReco.jl raw data structure to the acquisition data structure.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li><li><code>acqData::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L159-L169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.AdjustSubsampleIndices!" href="#MRINavigator.AdjustSubsampleIndices!"><code>MRINavigator.AdjustSubsampleIndices!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AdjustSubsampleIndices!(acqData::AcquisitionData)</code></pre><p>Add subsamples indices in the MRIReco.jl acquisition data structure. Needed when converting data not acquired in the first repetition.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>acqData::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L179-L189">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.ExtractNavigator" href="#MRINavigator.ExtractNavigator"><code>MRINavigator.ExtractNavigator</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">(nav, nav_time) = ExtractNavigator(rawData::RawAcquisitionData, slices::Union{Vector{Int64}, Nothing})</code></pre><p>Extract the navigator profiles from the MRIReco.jl raw data structure. These are registered with the same indices (contract, slice, encoding step) as the image data for the first echo time. Return a navigator array and a navigator time array. The navigator array has four dimensions in the following order: k-space samples, coils, k-space lines, slices. Effective only if the navigator profile was acquired after the first image profile.</p><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p><p><strong>Arguments</strong></p><ul><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L203-L215">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.selectEcho!" href="#MRINavigator.selectEcho!"><code>MRINavigator.selectEcho!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">SelectEcho!(acqd, idx_echo)</code></pre><p>Extract one or more echoes from the acquisition data structure</p><p><strong>Arguments</strong></p><ul><li><code>acqd::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>idx_echo::Vector{Int64}</code> - vector containing the indexes of the echoes to be selected (starting from 0)</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L262-L272">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.selectSlice!" href="#MRINavigator.selectSlice!"><code>MRINavigator.selectSlice!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">SelectSlice!(acqd, nav, nav_time, idx_slice)</code></pre><p>Extract one or more echoes from the acquisition data structure</p><p><strong>Arguments</strong></p><ul><li><code>acqd::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li><li><code>idx_slice::Vector{Int64}</code> - vector containing the indexes of the slices to be selected (starting from 0, downer slice)</li></ul><p><strong>Optional arguments with default value = nothing</strong></p><ul><li><code>nav::Union{Array{Complex{T}, 4}, Nothin} = nothing</code> - navigator profiles obtained with the ExtractNavigator function</li><li><code>nav_time::Union{Array{Complex{Float32}, 2}, Nothing}</code> - time stamps for the navigator data obtained with ExtractNavigator (in ms from the beginning of the day)</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/AdjustData.jl#L292-L306">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MRINavigator.additionalNavInput" href="#MRINavigator.additionalNavInput"><code>MRINavigator.additionalNavInput</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Data = additionalNavInput(
    noisemat::Array{Complex{Float32}, 2},
    rawData::RawAcquisitionData,
    acqData::AcquisitionData,
    acqMap::Union{AcquisitionData, Nothing} = nothing,
    nav_time::Union{Array{Complex{Float32}, 2}, Nothing} = nothing,
    trace::Union{Matrix{Float64}, Nothing} = nothing,
    centerline::Union{Vector{Float64}, Nothing} = nothing)</code></pre><p>Construct the additional data structure that is needed as input to navCorr!</p><p><strong>Arguments</strong></p><ul><li><code>noisemat::Array{Complex{Float32}, 2}</code> - noise data obtained with ExtractNoiseData!</li><li><code>rawData::RawAcquisitionData</code> - raw data structure obtained loading raw data with MRIReco.jl</li><li><code>acqData::AcquisitionData</code> - acquisition data structure obtained converting raw data with MRIReco.jl</li></ul><p><strong>Optional arguments with default value = nothing</strong></p><ul><li><code>acqMap::Union{AcquisitionData, Nothing} = nothing</code>       - acquisition data structure obtained converting reference data with MRIReco.jl</li><li><code>nav_time::Union{Array{Complex{Float32}, 2}, Nothing}</code>    - time stamps for the navigator data obtained with ExtractNavigator (in ms from the beginning of the day)</li><li><code>trace::Union{Matrix{Float64}, Nothing}</code>                  - respiratory trace time stamps and values in matrix with two colunms (1:time [ms], 2:trace).                                                               Include time points before and after the image acquisition (at least 2 s).</li><li><code>centerline::Union{Vector{Float64}, Nothing}</code>             - coordinates of the spinal cord ceterline obtained with callSCT</li></ul><p>MRIReco reference: https://onlinelibrary.wiley.com/doi/epdf/10.1002/mrm.28792</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NordicMRspine/MRINavigator.jl/blob/b8416e1ce0827959f5ccd70b39cbaeea2b647ddf/src/NavData.jl#L21-L46">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Pipelines/">« Pipelines</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 13 January 2025 09:39">Monday 13 January 2025</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
